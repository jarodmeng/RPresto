<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Implements a DBI compliant interface to Presto. Presto is
    an open source distributed SQL query engine for running interactive
    analytic queries against data sources of all sizes ranging from
    gigabytes to petabytes: &lt;https://prestodb.io/&gt;.">
<title>DBI Connector to Presto • RPresto</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="DBI Connector to Presto">
<meta property="og:description" content="Implements a DBI compliant interface to Presto. Presto is
    an open source distributed SQL query engine for running interactive
    analytic queries against data sources of all sizes ranging from
    gigabytes to petabytes: &lt;https://prestodb.io/&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">RPresto</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/common-table-expressions.html">Common Table Expressions (CTEs)</a>
    <a class="dropdown-item" href="articles/complex-types.html">Translating complex Presto data types</a>
    <a class="dropdown-item" href="articles/primitive-types.html">Primitive Presto data types to R types</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="https://github.com/prestodb/RPresto/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rpresto">RPresto<a class="anchor" aria-label="anchor" href="#rpresto"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>RPresto is a <a href="https://dbi.r-dbi.org/" class="external-link">DBI</a>-based adapter for the open source distributed SQL query engine <a href="https://prestodb.io/" class="external-link">Presto</a> for running interactive analytic queries.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>RPresto is both on <a href="https://cran.r-project.org/package=RPresto" class="external-link">CRAN</a> and <a href="https://github.com/prestodb/RPresto">github</a>.</p>
<p>For the CRAN version, you can use</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"RPresto"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of RPresto from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"prestodb/RPresto"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p><strong>The following examples assume that you have a in-memory Presto server set up locally.</strong> It’s the simplest server which stores all data and metadata in RAM on workers and both are discarded when Presto restarts. If you don’t have one set up, please refer to the <a href="https://prestodb.io/docs/current/connector/memory.html" class="external-link">memory connector documentation</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load libaries and connect to Presto</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/prestodb/RPresto">RPresto</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span></span>
<span>  drv <span class="op">=</span> <span class="fu">RPresto</span><span class="fu">::</span><span class="fu"><a href="reference/Presto.html">Presto</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  host <span class="op">=</span> <span class="st">"http://localhost"</span>,</span>
<span>  port <span class="op">=</span> <span class="fl">8080</span>,</span>
<span>  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"USER"</span><span class="op">)</span>,</span>
<span>  catalog <span class="op">=</span> <span class="st">"memory"</span>,</span>
<span>  schema <span class="op">=</span> <span class="st">"default"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>There are two levels of APIs: <code>DBI</code> and <code>dplyr</code>.</p>
<div class="section level3">
<h3 id="dbi-apis">
<code>DBI</code> APIs<a class="anchor" aria-label="anchor" href="#dbi-apis"></a>
</h3>
<p>The easiest and most flexible way of executing a <code>SELECT</code> query is using a <a href="https://dbi.r-dbi.org/reference/dbgetquery" class="external-link"><code>dbGetQuery()</code></a> call. It returns the query result in a <a href="https://tibble.tidyverse.org/" class="external-link"><code>tibble</code></a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"SELECT CAST(3.14 AS DOUBLE) AS pi"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span><span class="co">#&gt;      pi</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  3.14</span></span></code></pre></div>
<p><a href="https://dbi.r-dbi.org/reference/dbwritetable" class="external-link"><code>dbWriteTable()</code></a> can be used to write a small data frame into a Presto table.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Writing iris data frame into Presto</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"iris"</span>, <span class="va">iris</span><span class="op">)</span></span></code></pre></div>
<p><a href="https://dbi.r-dbi.org/reference/dbexiststable" class="external-link"><code>dbExistsTable()</code></a> checks if a table exists.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbExistsTable.html" class="external-link">dbExistsTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"iris"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p><a href="https://dbi.r-dbi.org/reference/dbreadtable" class="external-link"><code>dbReadTable()</code></a> reads the entire table into R. It’s essentially a <code>SELECT *</code> query on the table.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbReadTable.html" class="external-link">dbReadTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"iris"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 150 × 5</span></span>
<span><span class="co">#&gt;    sepal.length sepal.width petal.length petal.width species</span></span>
<span><span class="co">#&gt;           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  </span></span>
<span><span class="co">#&gt;  1          5.1         3.5          1.4         0.2 setosa </span></span>
<span><span class="co">#&gt;  2          4.9         3            1.4         0.2 setosa </span></span>
<span><span class="co">#&gt;  3          4.7         3.2          1.3         0.2 setosa </span></span>
<span><span class="co">#&gt;  4          4.6         3.1          1.5         0.2 setosa </span></span>
<span><span class="co">#&gt;  5          5           3.6          1.4         0.2 setosa </span></span>
<span><span class="co">#&gt;  6          5.4         3.9          1.7         0.4 setosa </span></span>
<span><span class="co">#&gt;  7          4.6         3.4          1.4         0.3 setosa </span></span>
<span><span class="co">#&gt;  8          5           3.4          1.5         0.2 setosa </span></span>
<span><span class="co">#&gt;  9          4.4         2.9          1.4         0.2 setosa </span></span>
<span><span class="co">#&gt; 10          4.9         3.1          1.5         0.1 setosa </span></span>
<span><span class="co">#&gt; # … with 140 more rows</span></span></code></pre></div>
<p><a href="https://dbi.r-dbi.org/reference/dbremovetable" class="external-link"><code>dbRemoveTable()</code></a> drops the table from Presto.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbRemoveTable.html" class="external-link">dbRemoveTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"iris"</span><span class="op">)</span></span></code></pre></div>
<p>You can execute a statement and returns the number of rows affected using <a href="https://dbi.r-dbi.org/reference/dbexecute" class="external-link"><code>dbExecute()</code></a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an empty table using CREATE TABLE</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbExecute.html" class="external-link">dbExecute</a></span><span class="op">(</span></span>
<span>  <span class="va">con</span>, <span class="st">"CREATE TABLE testing_table (field1 BIGINT, field2 VARCHAR)"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p><code><a href="https://dbi.r-dbi.org/reference/dbExecute.html" class="external-link">dbExecute()</a></code> returns the number of rows affected by the statement. Since a <code>CREATE TABLE</code> statement creates an empty table, it returns 0.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbExecute.html" class="external-link">dbExecute</a></span><span class="op">(</span></span>
<span>  <span class="va">con</span>,</span>
<span>  <span class="st">"INSERT INTO testing_table VALUES (1, 'abc'), (2, 'xyz')"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>Since 2 rows are inserted into the table, it returns 2.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check the previous INSERT statment works</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbReadTable.html" class="external-link">dbReadTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"testing_table"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span><span class="co">#&gt;   field1 field2</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 1      1 abc   </span></span>
<span><span class="co">#&gt; 2      2 xyz</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dplyr-apis">
<code>dplyr</code> APIs<a class="anchor" aria-label="anchor" href="#dplyr-apis"></a>
</h3>
<p>We also include <code>dplyr</code> database backend integration (which is mainly implemented using the <a href="https://dbplyr.tidyverse.org/" class="external-link"><code>dbplyr</code> package</a>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbplyr.tidyverse.org/" class="external-link">dbplyr</a></span><span class="op">)</span></span></code></pre></div>
<p>We can use <a href="https://dplyr.tidyverse.org/reference/copy_to.html" class="external-link"><code>dplyr::copy_to()</code></a> to write a local data frame to a <code>PrestoConnection</code> and immediately create a remote table on it.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add mtcars to Presto</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbExistsTable.html" class="external-link">dbExistsTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"mtcars"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbRemoveTable.html" class="external-link">dbRemoveTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"mtcars"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">tbl.mtcars</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/copy_to.html" class="external-link">copy_to</a></span><span class="op">(</span>dest <span class="op">=</span> <span class="va">con</span>, df <span class="op">=</span> <span class="va">mtcars</span>, name <span class="op">=</span> <span class="st">"mtcars"</span><span class="op">)</span></span>
<span><span class="co"># colnames() gives the column names</span></span>
<span><span class="va">tbl.mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"</span></span>
<span><span class="co">#&gt; [11] "carb"</span></span></code></pre></div>
<p><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link"><code>dplyr::tbl()</code></a> also work directly on the <code>PrestoConnection</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Treat "iris" in Presto as a remote data source that dplyr can now manipulate</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbExistsTable.html" class="external-link">dbExistsTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"iris"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"iris"</span>, <span class="va">iris</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">tbl.iris</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"iris"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl.iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "sepal.length" "sepal.width"  "petal.length" "petal.width"  "species"</span></span>
<span></span>
<span><span class="co"># dplyr verbs can be applied onto the remote data source</span></span>
<span><span class="va">tbl.iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    mean_sepal_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sepal.length</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span><span class="co">#&gt;   species    mean_sepal_length</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 setosa                  5.01</span></span>
<span><span class="co">#&gt; 2 versicolor              5.94</span></span>
<span><span class="co">#&gt; 3 virginica               6.59</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bigint-handling">
<code>BIGINT</code> handling<a class="anchor" aria-label="anchor" href="#bigint-handling"></a>
</h3>
<p>RPresto’s handling of <code>BIGINT</code> (i.e. 64-bit integers) is similar to other DBI packages (e.g. <a href="https://bigrquery.r-dbi.org/reference/bigquery.html" class="external-link"><code>bigrquery</code></a>, <a href="https://rpostgres.r-dbi.org/reference/postgres" class="external-link"><code>RPostgres</code></a>). We provide a <code>bigint</code> argument that users can use in multiple interfaces to specify how they want <code>BIGINT</code> typed data to be translated into R.</p>
<p>The <code>bigint</code> argument takes one of the following 4 possible values.</p>
<ol style="list-style-type: decimal">
<li><p><code>bigint = "integer"</code> is the default setting. It translates <code>BIGINT</code> to R’s native integer type (i.e. 32-bit integer). The range of 32-bit integer is <code>[-2,147,483,648, 2,147,483,647]</code> which should cover most integer use cases.</p></li>
<li><p>In case that you need to represent integer values outside of the 32-bit integer range, you have 2 options: <code>bigint = "numeric"</code> which translates the number into a <code>double</code> floating-point type in R; and <code>bigint = "integer64"</code> which packages the number using the <code><a href="https://rdrr.io/pkg/bit64/man/bit64-package.html" class="external-link">bit64::integer64</a></code> class. Note that both of those two approaches actually the same precision-preservation range: <code>+/-(2^53-1) = +/-9,007,199,254,740,991</code>, due to the fact that the Presto REST API uses JSON to encode the number and JSON has a limit at 53 bits (rather than 64 bits).</p></li>
<li><p><code>bigint = "character"</code> casts the number into a string. This is most useful when <code>BIGINT</code> is used to represent an ID rather than a real arithmetic number.</p></li>
</ol>
<div class="section level4">
<h4 id="where-to-use-bigint">Where to use <code>bigint</code>
<a class="anchor" aria-label="anchor" href="#where-to-use-bigint"></a>
</h4>
<p>The DBI interface function <code><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery()</a></code> is the most fundamental interface whereby <code>bigint</code> can be specified. All other interfaces are either built on top of <code><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery()</a></code> or only take effect when used with <code><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># BIGINT within the 32-bit integer range is simply translated into integer</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"SELECT CAST(1 AS BIGINT) AS small_bigint"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span><span class="co">#&gt;   small_bigint</span></span>
<span><span class="co">#&gt;          &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1            1</span></span>
<span></span>
<span><span class="co"># BIGINT outside of the 32-bit integer range generates a warning and returns NA</span></span>
<span><span class="co"># when bigint is not specified</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"SELECT CAST(POW(2, 31) AS BIGINT) AS overflow_bigint"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in as.integer.integer64(x): NAs produced by integer overflow</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span><span class="co">#&gt;   overflow_bigint</span></span>
<span><span class="co">#&gt;             &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1              NA</span></span>
<span></span>
<span><span class="co"># Using bigint to specify numeric or integer64 translations</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span></span>
<span>  <span class="va">con</span>, <span class="st">"SELECT CAST(POW(2, 31) AS BIGINT) AS bigint_numeric"</span>,</span>
<span>  bigint <span class="op">=</span> <span class="st">"numeric"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span><span class="co">#&gt;   bigint_numeric</span></span>
<span><span class="co">#&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     2147483648</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span></span>
<span>  <span class="va">con</span>, <span class="st">"SELECT CAST(POW(2, 31) AS BIGINT) AS bigint_integer64"</span>,</span>
<span>  bigint <span class="op">=</span> <span class="st">"integer64"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span><span class="co">#&gt;   bigint_integer64</span></span>
<span><span class="co">#&gt;            &lt;int64&gt;</span></span>
<span><span class="co">#&gt; 1       2147483648</span></span></code></pre></div>
<p>When used with the <code>dplyr</code> interface, <code>bigint</code> can be specified in two places.</p>
<ol style="list-style-type: decimal">
<li>Users can pass the <code>bigint</code> argument to <code><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect()</a></code> when creating the <code>PrestoConnection</code>. All queries that use the connection later will use the specified <code>bigint</code> setting.</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con.bigint</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span></span>
<span>  drv <span class="op">=</span> <span class="fu">RPresto</span><span class="fu">::</span><span class="fu"><a href="reference/Presto.html">Presto</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  host <span class="op">=</span> <span class="st">"http://localhost"</span>,</span>
<span>  port <span class="op">=</span> <span class="fl">8080</span>,</span>
<span>  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"USER"</span><span class="op">)</span>,</span>
<span>  catalog <span class="op">=</span> <span class="st">"memory"</span>,</span>
<span>  schema <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  <span class="co"># bigint can be specified in dbConnect</span></span>
<span>  bigint <span class="op">=</span> <span class="st">"integer64"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># BIGINT outside of the 32-bit integer range is automatically translated to</span></span>
<span><span class="co"># integer64, per the connection setting earlier</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span></span>
<span>  <span class="va">con.bigint</span>, <span class="st">"SELECT CAST(POW(2, 31) AS BIGINT) AS bigint_integer64"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span><span class="co">#&gt;   bigint_integer64</span></span>
<span><span class="co">#&gt;            &lt;int64&gt;</span></span>
<span><span class="co">#&gt; 1       2147483648</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>If you only want to specify <code>bigint</code> for a particular query when using the <code>dplyr</code> interface without affecting other queries, you can pass <code>bigint</code> to the <code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect()</a></code> call.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl.bigint</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span></span>
<span>  <span class="va">con</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sql.html" class="external-link">sql</a></span><span class="op">(</span><span class="st">"SELECT CAST(POW(2, 31) AS BIGINT) AS bigint"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default collect() generates a warning and returns NA</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="va">tbl.bigint</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in as.integer.integer64(x): NAs produced by integer overflow</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span><span class="co">#&gt;   bigint</span></span>
<span><span class="co">#&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1     NA</span></span>
<span></span>
<span><span class="co"># Passing bigint to collect() specifies BIGINT treatment</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="va">tbl.bigint</span>, bigint <span class="op">=</span> <span class="st">"integer64"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span><span class="co">#&gt;       bigint</span></span>
<span><span class="co">#&gt;      &lt;int64&gt;</span></span>
<span><span class="co">#&gt; 1 2147483648</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="connecting-to-trino">Connecting to Trino<a class="anchor" aria-label="anchor" href="#connecting-to-trino"></a>
</h2>
<p>To connect to Trino you must set the <code>use.trino.headers</code> parameter so <code>RPresto</code> knows to send the correct headers to the server. Otherwise all the same functionality is supported.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con.trino</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span></span>
<span>  <span class="fu">RPresto</span><span class="fu">::</span><span class="fu"><a href="reference/Presto.html">Presto</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  use.trino.headers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  host <span class="op">=</span> <span class="st">"http://localhost"</span>,</span>
<span>  port <span class="op">=</span> <span class="fl">8080</span>,</span>
<span>  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"USER"</span><span class="op">)</span>,</span>
<span>  schema <span class="op">=</span> <span class="st">"&lt;schema&gt;"</span>,</span>
<span>  catalog <span class="op">=</span> <span class="st">"&lt;catalog&gt;"</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"&lt;source&gt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="passing-extra-credentials-to-the-connector">Passing extra credentials to the connector<a class="anchor" aria-label="anchor" href="#passing-extra-credentials-to-the-connector"></a>
</h2>
<p>To pass extraCredentials that gets added to the <code>X-Presto-Extra-Credential</code> header use the <code>extra.credentials</code> parameter so <code>RPresto</code> will add that to the header while creating the <code>PrestoConnection</code>.</p>
<p>Set <code>use.trino.headers</code> if you want to pass extraCredentials through the <code>X-Trino-Extra-Credential</code> header.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span></span>
<span>  <span class="fu">RPresto</span><span class="fu">::</span><span class="fu"><a href="reference/Presto.html">Presto</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  host <span class="op">=</span> <span class="st">"http://localhost"</span>,</span>
<span>  port <span class="op">=</span> <span class="fl">7777</span>,</span>
<span>  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"USER"</span><span class="op">)</span>,</span>
<span>  schema <span class="op">=</span> <span class="st">"&lt;schema&gt;"</span>,</span>
<span>  catalog <span class="op">=</span> <span class="st">"&lt;catalog&gt;"</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"&lt;source&gt;"</span>,</span>
<span>  extra.credentials <span class="op">=</span> <span class="st">"test.token.foo=bar"</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-rpresto-works">How RPresto works<a class="anchor" aria-label="anchor" href="#how-rpresto-works"></a>
</h2>
<p>Presto exposes its interface via a REST based API<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;a href="https://github.com/prestodb/presto/wiki/HTTP-Protocol" class="external-link uri"&gt;https://github.com/prestodb/presto/wiki/HTTP-Protocol&lt;/a&gt; for a description of the API.&lt;/p&gt;'><sup>1</sup></a>. We utilize the <a href="https://github.com/r-lib/httr" class="external-link">httr</a> package to make the API calls and use <a href="https://github.com/jeroen/jsonlite" class="external-link">jsonlite</a> to reshape the data into a <code>tibble</code>.</p>
<p>RPresto has been tested on Presto 0.100.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>RPresto is BSD-licensed.</p>
</div>
</div>


  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=RPresto" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/prestodb/RPresto/">Browse source code</a></li>
<li><a href="https://github.com/prestodb/RPresto/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/BSD-3-Clause" class="external-link">BSD_3_clause</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing RPresto</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Onur Ismail Filiz <br><small class="roles"> Author </small>  </li>
<li>Sergey Goder <br><small class="roles"> Author </small>  </li>
<li>Jarod G.R. Meng <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Onur Ismail Filiz, Sergey Goder, Jarod G.R. Meng.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
